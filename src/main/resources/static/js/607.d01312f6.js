"use strict";(self["webpackChunkapp"]=self["webpackChunkapp"]||[]).push([[607,306],{7306:function(s,t,e){e.r(t),e.d(t,{default:function(){return h}});var i=function(){var s=this,t=s._self._c;return t("keep-alive",[t("div",{staticClass:"homepage",class:{cleanTop:"selfpage"===this.$route.name}},[t("van-pull-refresh",{on:{refresh:s.onRefresh},model:{value:s.refreshing,callback:function(t){s.refreshing=t},expression:"refreshing"}},[s.isEmpty?t("van-empty",{attrs:{description:"还没有帖子哦，快去发布吧!"}}):s._e(),t("van-list",{attrs:{finished:s.finished},model:{value:s.loading,callback:function(t){s.loading=t},expression:"loading"}},[s._l([1,2,3,4],(function(e){return 0!=s.postList.length||s.isEmpty?s._e():t("div",{staticClass:"item"},[t("van-skeleton",{attrs:{title:"",avatar:"",row:3}})],1)})),s._l(s.postList,(function(e,i){return t("div",{key:e.postId,staticClass:"item",on:{click:function(t){return s.goPostDetails(e.postId)}}},[t("div",{staticClass:"head"},[t("div",{staticClass:"touxiang"},[t("van-image",{attrs:{round:"",src:"https://img01.yzcdn.cn/vant/cat.jpeg"}})],1),t("div",{staticClass:"userNick"},[t("span",[s._v(s._s(e.postNick))])]),t("div",{staticClass:"option"},[t("van-icon",{attrs:{name:"arrow-down"}})],1)]),t("div",{staticClass:"center"},[t("p",[s._v(s._s(e.postContent))])]),t("div",{staticClass:"msg"},[t("span",{staticStyle:{"margin-right":"20px"}},[t("van-icon",{class:{redcolor:-1!=s.user.userLike?.split(",").indexOf(""+e.postId)},attrs:{name:"good-job-o"},on:{click:function(t){return t.stopPropagation(),s.like(e.postId)}}}),s._v("  "+s._s(e.postLike)+" ")],1),t("span",[t("van-icon",{attrs:{name:"chat-o"}}),s._v("  "+s._s(e.postComment)+" ")],1),t("span",{staticClass:"postDate"},[t("span",[s._v(s._s(e.postDate.substring(0,e.postDate.indexOf(" "))))])])])])}))],2)],1)],1)])},n=[],a=(e(7658),e(5101)),o=e(3822),r={name:"HomePage",props:["userId"],data(){return{user:{},postList:[],loading:!1,finished:!1,refreshing:!1,isEmpty:!1}},computed:{...(0,o.rn)(["userAccount"])},methods:{like(s){if(-1!=this.user.userLike?.split(",").indexOf(""+s))this.$toast.success("您已经赞过了");else{let t=this.user.userId;(0,a.vL)(s,t).then((s=>{this.getUser(),this.$toast.success("点赞成功"),"homepage"===this.$route.name?(0,a._K)().then((s=>{this.postList=s.reverse()})):this.queryPostByUserId()}))}},onRefresh(){this.finished=!1,this.loading=!0,this.refreshPost()},goPostDetails(s){this.$router.push({name:"postdetails",query:{postId:s}})},refreshPost(){this.postList=[],"homepage"===this.$route.name?(0,a._K)().then((s=>{this.postList=s.reverse(),0===s.length?this.isEmpty=!0:this.isEmpty=!1,this.refreshing=!1,this.finished=!0,this.loading=!1})):this.queryPostByUserId()},queryPostByUserId(){(0,a.I3)(this.userId).then((s=>{this.postList=s.reverse(),0===s.length?this.isEmpty=!0:this.isEmpty=!1,this.refreshing=!1,this.finished=!0,this.loading=!1}))},getUser(){(0,a.bc)(this.userAccount).then((s=>{this.user=s}))}},created(){"selfpage"===this.$route.name&&this.queryPostByUserId(),this.getUser()},activated(){this.getUser(),"selfpage"===this.$route.name?this.queryPostByUserId():this.refreshPost()},components:{}},c=r,l=e(1001),u=(0,l.Z)(c,i,n,!1,null,"60137b0e",null),h=u.exports},607:function(s,t,e){e.r(t),e.d(t,{default:function(){return p}});var i=function(){var s=this,t=s._self._c;return t("div",[t("div",{staticClass:"self"},[s.user?s._e():t("div",{staticClass:"goLogin",on:{click:s.goLogin}},[s._v(" 登录 / 注册 ")]),s.user?t("div",{staticClass:"userInfo"},[t("div",{staticClass:"touxiang"},[t("van-image",{attrs:{round:"",src:"https://img01.yzcdn.cn/vant/cat.jpeg"}})],1),t("div",{staticClass:"information"},[t("p",{staticClass:"nick"},[t("b",[s._v(s._s(s.user.userNick))])]),s._m(0)]),t("div",{staticClass:"setting",on:{click:s.clickSetBtn}},[t("van-icon",{attrs:{name:"setting-o"}})],1)]):s._e(),s.user?t("div",{staticClass:"selfinfo"},[s.user.userSelfinfo?s._e():t("span",[s._v("这是用户的个人介绍，点击编辑")]),s.user.userSelfinfo?t("span",[s._v(s._s(s.user.userSelfinfo))]):s._e()]):s._e(),s.user?t("div",{staticClass:"selfpost"},[t("HomePage",{attrs:{userId:s.user.userId}})],1):s._e()]),t("van-popup",{style:{height:"40px"},attrs:{position:"bottom"},model:{value:s.showSetting,callback:function(t){s.showSetting=t},expression:"showSetting"}},[t("button",{staticClass:"logout",on:{click:s.goLogin}},[s._v("退 出 登 录")])])],1)},n=[function(){var s=this,t=s._self._c;return t("div",{staticClass:"msg"},[t("span",[s._v("获赞 "),t("b",[s._v("0")])]),t("span",[s._v("粉丝 "),t("b",[s._v("0")])])])}],a=e(7306),o=e(5101),r=e(3822),c={name:"SelfPage",data(){return{showSetting:!1,user:null}},computed:{...(0,r.rn)(["token","userAccount"])},methods:{clickSetBtn(){this.showSetting=!0},goLogin(){localStorage.removeItem("userAccount"),localStorage.removeItem("token"),this.$router.replace({name:"login"})}},mounted(){(0,o.zE)(this.token).then((s=>{(0,o.bc)(this.userAccount).then((s=>{this.user=s}))}),(s=>{this.$toast.fail("服务器错误")}))},components:{HomePage:a["default"]}},l=c,u=e(1001),h=(0,u.Z)(l,i,n,!1,null,"3385218e",null),p=h.exports}}]);
//# sourceMappingURL=607.d01312f6.js.map