{"version":3,"file":"js/306.477138b2.js","mappings":"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","sources":["webpack://app/./src/views/Home/HomePage/index.vue","webpack://app/src/views/Home/HomePage/index.vue","webpack://app/./src/views/Home/HomePage/index.vue?9ed1","webpack://app/./src/views/Home/HomePage/index.vue?1aee"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('keep-alive',[_c('div',{staticClass:\"homepage\",class:{ cleanTop: this.$route.name === 'selfpage' }},[_c('van-pull-refresh',{on:{\"refresh\":_vm.onRefresh},model:{value:(_vm.refreshing),callback:function ($$v) {_vm.refreshing=$$v},expression:\"refreshing\"}},[(_vm.isEmpty)?_c('van-empty',{attrs:{\"description\":\"还没有帖子哦，快去发布吧!\"}}):_vm._e(),_c('van-list',{attrs:{\"finished\":_vm.finished},model:{value:(_vm.loading),callback:function ($$v) {_vm.loading=$$v},expression:\"loading\"}},[_vm._l(([1, 2, 3, 4]),function(item){return (_vm.postList.length == 0 && !_vm.isEmpty)?_c('div',{staticClass:\"item\"},[_c('van-skeleton',{attrs:{\"title\":\"\",\"avatar\":\"\",\"row\":3}})],1):_vm._e()}),_vm._l((_vm.postList),function(item,index){return _c('div',{key:item.postId,staticClass:\"item\",on:{\"click\":function($event){return _vm.goPostDetails(item.postId)}}},[_c('div',{staticClass:\"head\"},[_c('div',{staticClass:\"touxiang\"},[_c('van-image',{attrs:{\"round\":\"\",\"src\":\"https://img01.yzcdn.cn/vant/cat.jpeg\"}})],1),_c('div',{staticClass:\"userNick\"},[_c('span',[_vm._v(_vm._s(item.postNick))])]),_c('div',{staticClass:\"option\"},[_c('van-icon',{attrs:{\"name\":\"arrow-down\"}})],1)]),_c('div',{staticClass:\"center\"},[_c('p',[_vm._v(_vm._s(item.postContent))])]),_c('div',{staticClass:\"msg\"},[_c('span',{staticStyle:{\"margin-right\":\"20px\"}},[_c('van-icon',{class:{ redcolor: _vm.user.userLike?.split(',').indexOf('' + item.postId) != -1 },attrs:{\"name\":\"good-job-o\"},on:{\"click\":function($event){$event.stopPropagation();return _vm.like(item.postId)}}}),_vm._v(\"  \"+_vm._s(item.postLike)+\" \")],1),_c('span',[_c('van-icon',{attrs:{\"name\":\"chat-o\"}}),_vm._v(\"  \"+_vm._s(item.postComment)+\" \")],1),_c('span',{staticClass:\"postDate\"},[_c('span',[_vm._v(_vm._s(item.postDate.substring(0, item.postDate.indexOf(\" \"))))])])])])})],2)],1)],1)])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <keep-alive>\r\n    <div class=\"homepage\" :class=\"{ cleanTop: this.$route.name === 'selfpage' }\">\r\n\r\n      <van-pull-refresh v-model=\"refreshing\" @refresh=\"onRefresh\">\r\n        <van-empty v-if=\"isEmpty\" description=\"还没有帖子哦，快去发布吧!\" />\r\n        <van-list v-model=\"loading\" :finished=\"finished\">\r\n          <!-- 骨架屏 -->\r\n          <div v-if=\"postList.length == 0 && !isEmpty\" class=\"item\" v-for=\"item in [1, 2, 3, 4]\">\r\n            <van-skeleton title avatar :row=\"3\" />\r\n          </div>\r\n\r\n          <div class=\"item\" @click=\"goPostDetails(item.postId)\" v-for=\"(item, index) in postList\" :key=\"item.postId\">\r\n            <div class=\"head\">\r\n              <div class=\"touxiang\">\r\n                <van-image round src=\"https://img01.yzcdn.cn/vant/cat.jpeg\" />\r\n              </div>\r\n              <div class=\"userNick\">\r\n                <span>{{ item.postNick }}</span>\r\n              </div>\r\n\r\n              <div class=\"option\">\r\n                <van-icon name=\"arrow-down\" />\r\n              </div>\r\n            </div>\r\n            <div class=\"center\">\r\n              <p>{{ item.postContent }}</p>\r\n            </div>\r\n            <div class=\"msg\">\r\n              <span style=\"margin-right:20px;\"><van-icon\r\n                  :class=\"{ redcolor: user.userLike?.split(',').indexOf('' + item.postId) != -1 }\"\r\n                  @click.stop=\"like(item.postId)\" name=\"good-job-o\" /> &nbsp;{{\r\n                    item.postLike }} </span>\r\n              <span><van-icon name=\"chat-o\" /> &nbsp;{{ item.postComment }} </span>\r\n              <span class=\"postDate\">\r\n                <span>{{ item.postDate.substring(0, item.postDate.indexOf(\" \")) }}</span>\r\n              </span>\r\n            </div>\r\n          </div>\r\n        </van-list>\r\n      </van-pull-refresh>\r\n    </div>\r\n  </keep-alive>\r\n</template>\r\n\r\n<script>\r\nimport { queryAllPost, queryPostByUserId, getUserByUserAccount, like } from \"@/api\";\r\nimport { mapState } from \"vuex\";\r\nexport default {\r\n  name: \"HomePage\",\r\n  props: ['userId'],\r\n  data() {\r\n    return {\r\n      user: {},\r\n      postList: [],\r\n      loading: false,\r\n      finished: false,\r\n      refreshing: false,\r\n      isEmpty: false\r\n    };\r\n  },\r\n  computed: {\r\n    ...mapState([\"userAccount\"]),\r\n  },\r\n  methods: {\r\n    // 点赞\r\n    like(postId) {\r\n      if (this.user.userLike?.split(',').indexOf('' + postId) != -1) {\r\n        this.$toast.success(\"您已经赞过了\");\r\n      } else {\r\n        // 获取用户id\r\n        let userId = this.user.userId;\r\n        like(postId, userId).then(res => {\r\n          this.getUser();\r\n          this.$toast.success(\"点赞成功\");\r\n          if (this.$route.name === 'homepage') {\r\n            queryAllPost().then((res) => {\r\n              this.postList = res.reverse();\r\n            });\r\n          } else {\r\n            this.queryPostByUserId()\r\n          }\r\n        })\r\n      }\r\n\r\n    },\r\n    onRefresh() {\r\n      // 清空列表数据\r\n      this.finished = false;\r\n      // 重新加载数据\r\n      // 将 loading 设置为 true，表示处于加载状态\r\n      this.loading = true;\r\n      this.refreshPost();\r\n    },\r\n    goPostDetails(postId) {\r\n      this.$router.push({\r\n        name: 'postdetails',\r\n        query: {\r\n          postId\r\n        }\r\n      })\r\n    },\r\n    // 刷新帖子方法\r\n    refreshPost() {\r\n      this.postList = []\r\n      if (this.$route.name === 'homepage') {\r\n        queryAllPost().then((res) => {\r\n          this.postList = res.reverse();\r\n          if (res.length === 0) {\r\n            this.isEmpty = true;\r\n          } else {\r\n            this.isEmpty = false;\r\n          }\r\n          this.refreshing = false;\r\n          this.finished = true;\r\n          this.loading = false;\r\n        });\r\n      } else {\r\n        this.queryPostByUserId()\r\n      }\r\n    },\r\n    queryPostByUserId() {\r\n      queryPostByUserId(this.userId).then(res => {\r\n        this.postList = res.reverse();\r\n\r\n        if (res.length === 0) {\r\n          this.isEmpty = true;\r\n        } else {\r\n          this.isEmpty = false;\r\n        }\r\n        this.refreshing = false;\r\n        this.finished = true;\r\n        this.loading = false;\r\n      })\r\n    },\r\n    // 获取用户信息方法\r\n    getUser() {\r\n      // 获取用户\r\n      getUserByUserAccount(this.userAccount).then(res => {\r\n        this.user = res;\r\n      })\r\n    }\r\n  },\r\n  created() {\r\n    if (this.$route.name === \"selfpage\") {\r\n      this.queryPostByUserId();\r\n    }\r\n    this.getUser();\r\n  },\r\n  activated() {\r\n    this.getUser();\r\n    if (this.$route.name === \"selfpage\") {\r\n      this.queryPostByUserId();\r\n    } else {\r\n      this.refreshPost();\r\n    }\r\n\r\n  },\r\n  components: {},\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.redcolor {\r\n  color: red;\r\n}\r\n\r\n.homepage {\r\n  position: relative;\r\n  top: 60px;\r\n  margin-bottom: 60px;\r\n  background-color: #e5e7eb;\r\n  padding-bottom: 50px;\r\n}\r\n\r\n.item {\r\n  font-size: 14px;\r\n  width: 90%;\r\n  border-radius: 10px;\r\n  box-shadow: 0 8px 12px #ebedf0;\r\n  padding: 12px;\r\n  margin: 0 auto;\r\n  margin-top: 12px;\r\n  background-color: #fff;\r\n}\r\n\r\n.head {\r\n  margin-bottom: 10px;\r\n  height: 30px;\r\n  display: flex;\r\n  justify-content: space-around;\r\n}\r\n\r\n.touxiang {\r\n  width: 10%;\r\n  text-align: left;\r\n}\r\n\r\n.touxiang .van-image {\r\n  width: 28px;\r\n  height: 28px;\r\n}\r\n\r\n.userNick {\r\n  width: 50%;\r\n  height: 30px;\r\n  line-height: 30px;\r\n  text-align: left;\r\n  font-size: 12px;\r\n}\r\n\r\n.postDate {\r\n  float: right;\r\n  text-align: right;\r\n\r\n  color: #a3a3a3cc;\r\n}\r\n\r\n.option {\r\n  width: 30%;\r\n  text-align: right;\r\n}\r\n\r\n.center {\r\n  margin-bottom: 10px;\r\n  margin-left: 5px;\r\n}\r\n\r\n.cleanTop {\r\n  top: 0px;\r\n  margin-bottom: 0px;\r\n}\r\n\r\n.van-icon {\r\n  font-size: 20px;\r\n}\r\n</style>\r\n","import mod from \"-!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=60137b0e&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=60137b0e&prod&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"60137b0e\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","staticClass","class","cleanTop","$route","name","on","onRefresh","model","value","refreshing","callback","$$v","expression","isEmpty","attrs","_e","finished","loading","_l","item","postList","length","index","key","postId","$event","goPostDetails","_v","_s","postNick","postContent","staticStyle","redcolor","user","userLike","split","indexOf","stopPropagation","like","postLike","postComment","postDate","substring","staticRenderFns","props","data","computed","methods","queryAllPost","query","refreshPost","queryPostByUserId","getUser","getUserByUserAccount","created","activated","components","component"],"sourceRoot":""}